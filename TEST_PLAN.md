# 记账本应用测试计划

## 概述
本测试计划旨在系统性地验证记账本应用的所有功能模块，确保应用在用户注册、登录、记账操作、数据管理等方面能够正常工作。

## 测试环境
- **操作系统**: Android
- **开发环境**: Android Studio + Kotlin
- **数据库**: Room Database
- **UI框架**: Jetpack Compose
- **架构模式**: MVVM + Repository Pattern

## 测试策略

### 1. 单元测试 (Unit Testing)
**目标**: 验证单个组件或方法的正确性

#### 1.1 数据模型测试
- [ ] `Record.kt` - 记录数据模型验证
- [ ] `User.kt` - 用户数据模型验证
- [ ] `RecordType.kt` - 记录类型枚举验证

#### 1.2 Repository层测试
- [ ] `RecordRepository.kt` - 记录操作逻辑测试
- [ ] `AuthRepository.kt` - 用户认证逻辑测试

#### 1.3 ViewModel层测试
- [ ] `RecordViewModel.kt` - 记录业务逻辑测试
- [ ] `AuthViewModel.kt` - 用户认证业务逻辑测试

### 2. 集成测试 (Integration Testing)
**目标**: 验证模块间的协作

#### 2.1 数据库集成测试
- [ ] `AppDatabase.kt` - 数据库创建和迁移测试
- [ ] `RecordDao.kt` - 记录DAO操作测试
- [ ] `UserDao.kt` - 用户DAO操作测试

#### 2.2 ViewModel与Repository集成
- [ ] RecordViewModel与RecordRepository集成测试
- [ ] AuthViewModel与AuthRepository集成测试

### 3. UI测试 (UI Testing)
**目标**: 验证用户界面的交互和显示

#### 3.1 登录界面测试
- [ ] `LoginScreen.kt` - 登录功能测试
- [ ] 用户名/密码输入验证
- [ ] 登录成功/失败处理

#### 3.2 注册界面测试
- [ ] `RegisterScreen.kt` - 注册功能测试
- [ ] 表单验证测试
- [ ] 注册成功/失败处理

#### 3.3 记录列表界面测试
- [ ] `RecordListScreen.kt` - 记录列表显示测试
- [ ] 记录增删改查操作测试
- [ ] 空状态显示测试

#### 3.4 添加记录界面测试
- [ ] `AddRecordScreen.kt` - 添加记录功能测试
- [ ] 表单验证测试
- [ ] 分类选择功能测试

#### 3.5 编辑记录界面测试
- [ ] `EditRecordScreen.kt` - 编辑记录功能测试
- [ ] 数据预填充测试
- [ ] 保存/取消操作测试

#### 3.6 统计界面测试
- [ ] `StatisticsScreen.kt` - 统计功能测试
- [ ] 数据可视化测试
- [ ] 收入支出统计测试

### 4. 功能测试 (Functional Testing)

#### 4.1 用户管理功能
- [ ] 用户注册流程
- [ ] 用户登录流程
- [ ] 用户登出流程
- [ ] 用户数据隔离验证

#### 4.2 记录管理功能
- [ ] 添加收入记录
- [ ] 添加支出记录
- [ ] 编辑现有记录
- [ ] 删除记录
- [ ] 记录列表展示

#### 4.3 数据统计功能
- [ ] 总收入计算
- [ ] 总支出计算
- [ ] 余额计算
- [ ] 分类统计

#### 4.4 导航功能
- [ ] `AppNavHost.kt` - 应用导航测试
- [ ] 页面间跳转测试
- [ ] 返回栈管理测试

### 5. 边界测试 (Boundary Testing)

#### 5.1 输入边界测试
- [ ] 金额输入边界值（0，负数，极大值）
- [ ] 字符串长度边界
- [ ] 日期边界值

#### 5.2 数据边界测试
- [ ] 空记录列表处理
- [ ] 大量记录性能测试
- [ ] 并发操作测试

### 6. 性能测试 (Performance Testing)

#### 6.1 响应时间测试
- [ ] 页面加载时间
- [ ] 数据库操作响应时间
- [ ] 列表滚动性能

#### 6.2 内存使用测试
- [ ] 内存泄漏检测
- [ ] 大列表内存优化

### 7. 兼容性测试 (Compatibility Testing)

#### 7.1 Android版本兼容性
- [ ] 支持的最低Android版本
- [ ] 不同Android版本功能验证

#### 7.2 屏幕适配性测试
- [ ] 不同屏幕尺寸适配
- [ ] 横竖屏切换测试

### 8. 安全测试 (Security Testing)

#### 8.1 数据安全
- [ ] 用户密码加密存储
- [ ] 敏感数据保护

#### 8.2 权限测试
- [ ] 应用权限申请
- [ ] 数据访问权限

## 测试用例详情

### 用例1: 用户注册流程
**测试目标**: 验证用户能够成功注册
**前置条件**: 应用已启动
**测试步骤**:
1. 点击"注册"按钮
2. 输入用户名和密码
3. 确认密码
4. 点击"注册"按钮
5. 验证注册成功提示
6. 自动跳转到登录页面

**预期结果**: 用户成功注册，可以正常登录

### 用例2: 用户登录和数据隔离
**测试目标**: 验证不同用户数据隔离
**前置条件**: 存在多个用户账号
**测试步骤**:
1. 用户A登录并添加记录1
2. 用户A登出
3. 用户B登录
4. 验证用户B看不到用户A的记录
5. 用户B添加记录2
6. 验证用户B只能看到自己的记录

**预期结果**: 不同用户数据完全隔离

### 用例3: 添加记录表单验证
**测试目标**: 验证表单输入验证逻辑
**前置条件**: 用户已登录
**测试步骤**:
1. 进入添加记录页面
2. 不输入金额，点击保存
3. 输入负数金额，点击保存
4. 输入0金额，点击保存
5. 输入有效金额，不选择分类，点击保存
6. 输入有效金额和分类，点击保存

**预期结果**: 正确显示错误提示，只有有效输入才能保存

### 用例4: 记录编辑功能
**测试目标**: 验证记录编辑功能
**前置条件**: 存在可编辑的记录
**测试步骤**:
1. 长按记录项
2. 进入编辑页面
3. 修改记录信息
4. 点击保存
5. 验证记录已更新
6. 取消编辑，验证记录未改变

**预期结果**: 记录编辑功能正常工作

### 用例5: 统计功能验证
**测试目标**: 验证统计数据的准确性
**前置条件**: 存在多条收入和支出记录
**测试步骤**:
1. 进入统计页面
2. 验证总收入计算正确
3. 验证总支出计算正确
4. 验证余额计算正确
5. 验证分类统计正确

**预期结果**: 所有统计数据准确显示

## 测试工具和框架

### 单元测试
- JUnit 4/5
- MockK (用于模拟依赖)
- Coroutines Test (用于测试协程)

### UI测试
- Espresso
- Compose Testing
- UI Automator

### 性能测试
- Android Profiler
- Memory Profiler

### 测试覆盖率
- JaCoCo (代码覆盖率工具)

## 测试执行计划

### 第一阶段: 单元测试 (预计2天)
- 完成所有数据模型和Repository的单元测试
- 完成ViewModel的业务逻辑测试

### 第二阶段: 集成测试 (预计2天)
- 完成数据库集成测试
- 完成模块间集成测试

### 第三阶段: UI测试 (预计3天)
- 完成所有界面的UI测试
- 完成用户交互测试

### 第四阶段: 功能测试 (预计2天)
- 完成端到端功能测试
- 完成边界和性能测试

## 风险与缓解措施

### 风险1: 测试环境不稳定
**缓解措施**: 使用模拟数据和稳定的测试环境

### 风险2: 测试覆盖不全面
**缓解措施**: 制定详细的测试用例，定期评审测试覆盖率

### 风险3: 测试数据管理复杂
**缓解措施**: 使用测试数据管理工具，自动清理测试数据

## 验收标准

### 功能验收标准
- [ ] 所有核心功能正常工作
- [ ] 用户数据隔离正确实现
- [ ] 应用响应时间在可接受范围内
- [ ] 无重大bug或崩溃

### 质量验收标准
- [ ] 代码覆盖率 > 80%
- [ ] 通过所有单元测试
- [ ] 通过所有集成测试
- [ ] 通过所有UI测试

## 测试报告

测试完成后将生成详细的测试报告，包括:
- 测试执行摘要
- 通过/失败统计
- 问题跟踪
- 改进建议

## 后续维护

测试计划将根据应用功能的更新进行维护和更新，确保测试的持续有效性。